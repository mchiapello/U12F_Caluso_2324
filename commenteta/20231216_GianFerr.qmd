---
title: "Gianferr - BCV Caluso"
subtitle: "Ritorno - 2023/12/16"
date: 11/11/2023
categories: ['U12F', '2023-2024', 'Primo Campionato', 'Andata']
format:
  html:
    toc: false
    theme: journal
    page-layout: article
    number-sections: false
execute:
  echo: false
  message: false
  warning: false
---

```{r}
#| include: false
# Load libraries
library(tidyverse)
library(datavolley)
library(gt)
library(gtExtras)
library(patchwork)
source(paste0(here::here(), "/scripts/999_utils.R"))

# Read data
file <- fs::dir_ls(paste0(here::here(), "/partite/2023-11-11_GianFerr"), 
                   regexp = "dvw$")
x <- dv_read(file)
noi <- "BCV Caluso"
loro <- teams(x)[teams(x) != noi]
px <- plays(x)

################################################################################
# Functions
add <- function(x, home = TRUE){
  tmp <- x$lab
  if (home == TRUE){
    x |> 
      bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                       y = c(1, 2, 2, 2, 1, 1),
                       lab = tmp[c(2, 3, 4, 5, 6, 1)], 
                       rot = "R2")) |> 
      bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                       y = c(1, 2, 2, 2, 1, 1),
                       lab = tmp[c(3, 4, 5, 6, 1, 2)], 
                       rot = "R3")) |> 
      bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                       y = c(1, 2, 2, 2, 1, 1),
                       lab = tmp[c(4, 5, 6, 1, 2, 3)], 
                       rot = "R4")) |> 
      bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                       y = c(1, 2, 2, 2, 1, 1),
                       lab = tmp[c(5, 6, 1, 2, 3, 4)], 
                       rot = "R5")) |> 
      bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                       y = c(1, 2, 2, 2, 1, 1),
                       lab = tmp[c(6, 1, 2, 3, 4, 5)], 
                       rot = "R6"))
  } else {
    x |> 
      bind_rows(tibble(x = c(1,1,2,3,3,2),
                       y = c(4,3,3,3,4,4),
                       lab = tmp[c(2, 3, 4, 5, 6, 1)], 
                       rot = "R2")) |> 
      bind_rows(tibble(x = c(1,1,2,3,3,2),
                       y = c(4,3,3,3,4,4),
                       lab = tmp[c(3, 4, 5, 6, 1, 2)], 
                       rot = "R3")) |> 
      bind_rows(tibble(x = c(1,1,2,3,3,2),
                       y = c(4,3,3,3,4,4),
                       lab = tmp[c(4, 5, 6, 1, 2, 3)], 
                       rot = "R4")) |> 
      bind_rows(tibble(x = c(1,1,2,3,3,2),
                       y = c(4,3,3,3,4,4),
                       lab = tmp[c(5, 6, 1, 2, 3, 4)], 
                       rot = "R5")) |> 
      bind_rows(tibble(x = c(1,1,2,3,3,2),
                       y = c(4,3,3,3,4,4),
                       lab = tmp[c(6, 1, 2, 3, 4, 5)], 
                       rot = "R6"))
  }
}
```

# Matchup

```{r}
# Define home and away teams
home <- x$meta$teams$team[1]
away <- x$meta$teams$team[2]
# Define parameters
court_colour <- "white"
grid_colour <- "black"
```

### Set1

```{r}
# Extract rotation---- 
if(home == "BCV Caluso"){
  tmp1 <- x$meta$players_h |> 
  filter(starting_position_set1 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set1) |> 
  pull(number)
  caluso <- tibble(x = c(3, 3, 2, 1, 1, 2),
       y = c(1, 2, 2, 2, 1, 1),
       lab = tmp1,
       rot = "R001", 
       team = home)
  tmp2 <- x$meta$players_v |> 
  filter(starting_position_set1 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set1) |> 
  pull(number)
  others <- tibble(x = c(1,1,2,3,3,2),
       y = c(4,3,3,3,4,4),
       lab = tmp2,
       rot = "R001",
       team = away)
} else {
  tmp1 <- x$meta$players_h |> 
  filter(starting_position_set1 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set1) |> 
  pull(number)
  others <- tibble(x = c(1,1,2,3,3,2),
       y = c(4,3,3,3,4,4),
       lab = tmp1,
       rot = "R001",
       team = away)
  tmp2 <- x$meta$players_v |> 
  filter(starting_position_set1 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set1) |> 
  pull(number)  
  set1hr <- tibble(x = c(3, 3, 2, 1, 1, 2),
       y = c(1, 2, 2, 2, 1, 1),
       lab = tmp2,
       rot = "R001", 
       team = home)
}

# caluso <- add(caluso, home = TRUE)
# others <- add(others, home = FALSE)

ss <- px |> 
  filter(set_number == "1",
         skill == "Serve") |> 
  slice(1) |> 
  pull(team)

# Create rotation----
if(ss != "BCV Caluso"){
  caluso <- caluso |> 
    mutate(serve = "no")
  others <- others |> 
    mutate(serve = "yes")
  ctmp <- caluso$lab
  otmp <- others$lab
  df <- others |> 
    bind_rows(caluso) |> 
    bind_rows(others |> 
                mutate(rot = "R002",
                       serve= "no",
                       team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R002",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R004",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R004",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R006",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R006",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R008",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R008",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R010",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R010",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R012",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(1, 2, 3, 4, 5, 6)],
                     rot = "R012",
                     serve = "yes",
                     team = home))
}  else {
  caluso <- caluso |> 
    mutate(serve = "yes")
  others <- others |> 
    mutate(serve = "no")
  ctmp <- caluso$lab
  otmp <- others$lab
  df <- others |> 
    bind_rows(caluso) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R002",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(1, 2, 3, 4, 5, 6)],
                     rot = "R002",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R004",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R004",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R006",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R006",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R008",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R008",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R010",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R010",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(1, 2, 3, 4, 5, 6)],
                     rot = "R012",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R012",
                     serve = "no",
                     team = home))
}

# Plot----
df |> 
  mutate(x2 = case_when(serve == "yes" & team != home ~ 1,
                        serve == "yes" & team == home ~ 3),
         y2 = case_when(serve == "yes" & team != home ~ 4.5,
                        serve == "yes" & team == home ~ .5)) |> 
  # mutate(reception = ifelse(lab == 11, "# 50%\n+80%", NA),
  #        coord_X = x - .3,
  #        coord_Y = y + .5) |>
  ggplot(aes(x, y, label = lab)) +
  annotate(geom = "rect", xmin = 0.5, xmax = 3.5, 
           ymin = 0.5, ymax = 4.5, 
           fill = court_colour, 
           colour = "black") +
  annotate(geom = "rect", xmin = 0.3, xmax = 3.7, 
                  ymin = 2.48, ymax = 2.6, 
                  fill = grid_colour) +
  annotate("segment", x = 1.5, xend = 1.5, y = .5, yend = 4.5,
           colour = grid_colour) +
  annotate("segment", x = 2.5, xend = 2.5, y = .5, yend = 4.5,
           colour = grid_colour) +
  annotate("segment", x = .5, xend = 3.5, y = 1.7, yend = 1.7,
           colour = grid_colour) +
  annotate("segment", x = .5, xend = 3.5, y = 3.3, yend = 3.3,
         colour = grid_colour) +
  geom_point(aes(x2, y2), 
             size = 5) +
  # geom_text(aes(coord_X, coord_Y, label = reception)) +
  geom_text(size = 7) +
  theme_void() +
  facet_wrap(vars(rot)) 
  

```

### Set2

```{r}
# Extract rotation---- 
if(home == "BCV Caluso"){
  tmp1 <- x$meta$players_h |> 
  filter(starting_position_set2 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set2) |> 
  pull(number)
  caluso <- tibble(x = c(3, 3, 2, 1, 1, 2),
       y = c(1, 2, 2, 2, 1, 1),
       lab = tmp1,
       rot = "R001", 
       team = home)
  tmp2 <- x$meta$players_v |> 
  filter(starting_position_set2 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set2) |> 
  pull(number)
  others <- tibble(x = c(1,1,2,3,3,2),
       y = c(4,3,3,3,4,4),
       lab = tmp2,
       rot = "R001",
       team = away)
} else {
  tmp1 <- x$meta$players_h |> 
  filter(starting_position_set2 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set2) |> 
  pull(number)
  others <- tibble(x = c(1,1,2,3,3,2),
       y = c(4,3,3,3,4,4),
       lab = tmp1,
       rot = "R001",
       team = away)
  tmp2 <- x$meta$players_v |> 
  filter(starting_position_set2 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set2) |> 
  pull(number)  
  set1hr <- tibble(x = c(3, 3, 2, 1, 1, 2),
       y = c(1, 2, 2, 2, 1, 1),
       lab = tmp2,
       rot = "R001", 
       team = home)
}

ss <- px |> 
  filter(set_number == "2",
         skill == "Serve") |> 
  slice(1) |> 
  pull(team)

# Create rotation----
if(ss != "BCV Caluso"){
  caluso <- caluso |> 
    mutate(serve = "no")
  others <- others |> 
    mutate(serve = "yes")
  ctmp <- caluso$lab
  otmp <- others$lab
  df <- others |> 
    bind_rows(caluso) |> 
    bind_rows(others |> 
                mutate(rot = "R002",
                       serve= "no",
                       team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R002",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R004",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R004",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R006",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R006",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R008",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R008",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R010",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R010",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R012",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(1, 2, 3, 4, 5, 6)],
                     rot = "R012",
                     serve = "yes",
                     team = home))
} else {
  caluso <- caluso |> 
    mutate(serve = "yes")
  others <- others |> 
    mutate(serve = "no")
  ctmp <- caluso$lab
  otmp <- others$lab
  df <- others |> 
    bind_rows(caluso) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R002",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(1, 2, 3, 4, 5, 6)],
                     rot = "R002",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R004",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R004",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R006",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R006",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R008",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R008",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R010",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R010",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(1, 2, 3, 4, 5, 6)],
                     rot = "R012",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R012",
                     serve = "no",
                     team = home))
}


# Plot----
df |> 
  mutate(x2 = case_when(serve == "yes" & team != home ~ 1,
                        serve == "yes" & team == home ~ 3),
         y2 = case_when(serve == "yes" & team != home ~ 4.5,
                        serve == "yes" & team == home ~ .5)) |> 
  # mutate(reception = ifelse(lab == 11, "# 50%\n+80%", NA),
  #        coord_X = x - .3,
  #        coord_Y = y + .5) |>
  ggplot(aes(x, y, label = lab)) +
  annotate(geom = "rect", xmin = 0.5, xmax = 3.5, 
           ymin = 0.5, ymax = 4.5, 
           fill = court_colour, 
           colour = "black") +
  annotate(geom = "rect", xmin = 0.3, xmax = 3.7, 
                  ymin = 2.48, ymax = 2.6, 
                  fill = grid_colour) +
  annotate("segment", x = 1.5, xend = 1.5, y = .5, yend = 4.5,
           colour = grid_colour) +
  annotate("segment", x = 2.5, xend = 2.5, y = .5, yend = 4.5,
           colour = grid_colour) +
  annotate("segment", x = .5, xend = 3.5, y = 1.7, yend = 1.7,
           colour = grid_colour) +
  annotate("segment", x = .5, xend = 3.5, y = 3.3, yend = 3.3,
         colour = grid_colour) +
  geom_point(aes(x2, y2), 
             size = 5) +
  # geom_text(aes(coord_X, coord_Y, label = reception)) +
  geom_text(size = 7) +
  theme_void() +
  facet_wrap(vars(rot)) 
  

```


### Set3

```{r}

# Extract rotation---- 

if(home == "BCV Caluso"){
  tmp1 <- x$meta$players_h |> 
  filter(starting_position_set3 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set3) |> 
  pull(number)
  caluso <- tibble(x = c(3, 3, 2, 1, 1, 2),
       y = c(1, 2, 2, 2, 1, 1),
       lab = tmp1,
       rot = "R001", 
       team = home)
  tmp2 <- x$meta$players_v |> 
  filter(starting_position_set3 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set3) |> 
  pull(number)
  others <- tibble(x = c(1,1,2,3,3,2),
       y = c(4,3,3,3,4,4),
       lab = tmp2,
       rot = "R001",
       team = away)
} else {
  tmp1 <- x$meta$players_h |> 
  filter(starting_position_set3 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set3) |> 
  pull(number)
  others <- tibble(x = c(1,1,2,3,3,2),
       y = c(4,3,3,3,4,4),
       lab = tmp1,
       rot = "R001",
       team = away)
  tmp2 <- x$meta$players_v |> 
  filter(starting_position_set3 %in% c(1,2,3,4,5,6)) |> 
  arrange(starting_position_set3) |> 
  pull(number)  
  set1hr <- tibble(x = c(3, 3, 2, 1, 1, 2),
       y = c(1, 2, 2, 2, 1, 1),
       lab = tmp2,
       rot = "R001", 
       team = home)
}

# Serving team
ss <- px |> 
  filter(set_number == "3",
         skill == "Serve") |> 
  slice(1) |> 
  pull(team)

# Create rotation----
if(ss != "BCV Caluso"){
  caluso <- caluso |> 
    mutate(serve = "no")
  others <- others |> 
    mutate(serve = "yes")
  ctmp <- caluso$lab
  otmp <- others$lab
  df <- others |> 
    bind_rows(caluso) |> 
    bind_rows(others |> 
                mutate(rot = "R002",
                       serve= "no",
                       team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R002",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R004",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R004",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R006",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R006",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R008",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R008",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R010",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R010",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R012",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(1, 2, 3, 4, 5, 6)],
                     rot = "R012",
                     serve = "yes",
                     team = home))
} else {
  caluso <- caluso |> 
    mutate(serve = "yes")
  others <- others |> 
    mutate(serve = "no")
  ctmp <- caluso$lab
  otmp <- others$lab
  df <- others |> 
    bind_rows(caluso) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R002",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(1, 2, 3, 4, 5, 6)],
                     rot = "R002",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R003",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R004",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(2, 3, 4, 5, 6, 1)],
                     rot = "R004",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R005",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R006",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(3, 4, 5, 6, 1, 2)],
                     rot = "R006",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R007",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R008",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(4, 5, 6, 1, 2, 3)],
                     rot = "R008",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R009",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R010",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(5, 6, 1, 2, 3, 4)],
                     rot = "R010",
                     serve = "no",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "no",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R011",
                     serve = "yes",
                     team = home)) |> 
    bind_rows(tibble(x = c(1,1,2,3,3,2),
                     y = c(4,3,3,3,4,4),
                     lab = otmp[c(1, 2, 3, 4, 5, 6)],
                     rot = "R012",
                     serve = "yes",
                     team = away)) |> 
    bind_rows(tibble(x = c(3, 3, 2, 1, 1, 2),
                     y = c(1, 2, 2, 2, 1, 1),
                     lab = ctmp[c(6, 1, 2, 3, 4, 5)],
                     rot = "R012",
                     serve = "no",
                     team = home))
}

# Plot----
df |> 
  mutate(x2 = case_when(serve == "yes" & team != home ~ 1,
                        serve == "yes" & team == home ~ 3),
         y2 = case_when(serve == "yes" & team != home ~ 4.5,
                        serve == "yes" & team == home ~ .5)) |> 
  # mutate(reception = ifelse(lab == 11, "# 50%\n+80%", NA),
  #        coord_X = x - .3,
  #        coord_Y = y + .5) |>
  ggplot(aes(x, y, label = lab)) +
  annotate(geom = "rect", xmin = 0.5, xmax = 3.5, 
           ymin = 0.5, ymax = 4.5, 
           fill = court_colour, 
           colour = "black") +
  annotate(geom = "rect", xmin = 0.3, xmax = 3.7, 
                  ymin = 2.48, ymax = 2.6, 
                  fill = grid_colour) +
  annotate("segment", x = 1.5, xend = 1.5, y = .5, yend = 4.5,
           colour = grid_colour) +
  annotate("segment", x = 2.5, xend = 2.5, y = .5, yend = 4.5,
           colour = grid_colour) +
  annotate("segment", x = .5, xend = 3.5, y = 1.7, yend = 1.7,
           colour = grid_colour) +
  annotate("segment", x = .5, xend = 3.5, y = 3.3, yend = 3.3,
         colour = grid_colour) +
  geom_point(aes(x2, y2), 
             size = 5) +
  # geom_text(aes(coord_X, coord_Y, label = reception)) +
  geom_text(size = 7) +
  theme_void() +
  facet_wrap(vars(rot)) 
  

```